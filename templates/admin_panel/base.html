<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}Streamify Admin{% endblock %}</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg:        #09090f;
  --bg-2:      #0f0f18;
  --bg-3:      #16161f;
  --bg-4:      #1c1c28;
  --border:    rgba(255,255,255,0.07);
  --border-2:  rgba(255,255,255,0.12);
  --text:      #e8e8f0;
  --muted:     #6b6b85;
  --muted-2:   #9090aa;
  --accent:    #7c5cfc;
  --accent-2:  #a07cf8;
  --accent-glow: rgba(124,92,252,0.3);
  --green:     #22d98a;
  --red:       #ff5370;
  --amber:     #ffb86c;
  --blue:      #4dc4ff;
  --sidebar-w: 240px;
  --header-h:  60px;
}

html, body { height: 100%; font-family: 'DM Sans', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; }

/* â”€â”€ SCROLLBAR â”€â”€ */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--bg-4); border-radius: 2px; }

/* â”€â”€ LAYOUT â”€â”€ */
.layout { display: flex; min-height: 100vh; }

/* â”€â”€ SIDEBAR â”€â”€ */
.sidebar {
  width: var(--sidebar-w);
  background: var(--bg-2);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0; left: 0; bottom: 0;
  z-index: 100;
  transition: transform 0.3s ease;
}

.sidebar-logo {
  padding: 20px 20px 16px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo-icon {
  width: 32px; height: 32px;
  background: linear-gradient(135deg, var(--accent), #5b3fd4);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
  box-shadow: 0 0 20px var(--accent-glow);
}

.logo-text {
  font-family: 'Syne', sans-serif;
  font-weight: 800;
  font-size: 15px;
  letter-spacing: 0.02em;
}

.logo-text span { color: var(--accent-2); }

.sidebar-label {
  padding: 16px 20px 6px;
  font-size: 9px;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--muted);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 9px 20px;
  margin: 1px 8px;
  border-radius: 8px;
  font-size: 13.5px;
  font-weight: 400;
  color: var(--muted-2);
  text-decoration: none;
  transition: all 0.15s;
  cursor: pointer;
}

.nav-item:hover { background: var(--bg-3); color: var(--text); }

.nav-item.active {
  background: rgba(124,92,252,0.15);
  color: var(--accent-2);
  font-weight: 500;
}

.nav-item svg { width: 16px; height: 16px; opacity: 0.8; flex-shrink: 0; }
.nav-item.active svg { opacity: 1; }

.nav-badge {
  margin-left: auto;
  background: var(--accent);
  color: #fff;
  font-size: 10px;
  font-weight: 600;
  padding: 1px 6px;
  border-radius: 20px;
}

.sidebar-footer {
  margin-top: auto;
  padding: 16px;
  border-top: 1px solid var(--border);
}

.admin-card {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  background: var(--bg-3);
  border-radius: 10px;
}

.admin-avatar {
  width: 32px; height: 32px;
  background: linear-gradient(135deg, var(--accent), #5b3fd4);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-weight: 700;
  font-size: 13px;
  flex-shrink: 0;
}

.admin-name { font-size: 12px; font-weight: 500; line-height: 1.3; }
.admin-role { font-size: 10px; color: var(--muted); }

/* â”€â”€ MAIN â”€â”€ */
.main {
  margin-left: var(--sidebar-w);
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* â”€â”€ HEADER â”€â”€ */
.header {
  height: var(--header-h);
  background: var(--bg-2);
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  padding: 0 28px;
  gap: 16px;
  position: sticky;
  top: 0;
  z-index: 50;
}

.header-title {
  font-family: 'Syne', sans-serif;
  font-weight: 700;
  font-size: 16px;
}

.header-breadcrumb {
  font-size: 12px;
  color: var(--muted);
  display: flex;
  align-items: center;
  gap: 6px;
  margin-left: 4px;
}

.header-right { margin-left: auto; display: flex; align-items: center; gap: 12px; }

.header-search {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--bg-3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 7px 12px;
  font-size: 13px;
  color: var(--text);
}

.header-search input {
  background: none; border: none; outline: none;
  color: var(--text); font-size: 13px; width: 180px;
  font-family: 'DM Sans', sans-serif;
}

.header-search svg { width: 14px; height: 14px; color: var(--muted); }

/* â”€â”€ CONTENT AREA â”€â”€ */
.content { padding: 28px; flex: 1; }

/* â”€â”€ STAT CARDS â”€â”€ */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 28px;
}

.stat-card {
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 20px;
  position: relative;
  overflow: hidden;
  transition: border-color 0.2s;
}

.stat-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: var(--card-accent, var(--accent));
  opacity: 0.8;
}

.stat-card:hover { border-color: var(--border-2); }

.stat-icon {
  width: 36px; height: 36px;
  background: var(--card-icon-bg, rgba(124,92,252,0.15));
  border-radius: 9px;
  display: flex; align-items: center; justify-content: center;
  margin-bottom: 14px;
}

.stat-icon svg { width: 18px; height: 18px; }

.stat-value {
  font-family: 'Syne', sans-serif;
  font-weight: 700;
  font-size: 26px;
  line-height: 1;
  margin-bottom: 4px;
}

.stat-label { font-size: 12px; color: var(--muted); font-weight: 400; }

.stat-delta {
  position: absolute;
  top: 20px; right: 20px;
  font-size: 11px;
  font-weight: 500;
  padding: 3px 7px;
  border-radius: 6px;
}

.delta-up { background: rgba(34,217,138,0.12); color: var(--green); }
.delta-down { background: rgba(255,83,112,0.12); color: var(--red); }

/* â”€â”€ PANELS â”€â”€ */
.panel {
  background: var(--bg-2);
  border: 1px solid var(--border);
  border-radius: 14px;
  overflow: hidden;
}

.panel-header {
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 10px;
}

.panel-title {
  font-family: 'Syne', sans-serif;
  font-weight: 700;
  font-size: 14px;
}

.panel-actions { margin-left: auto; display: flex; gap: 8px; }

.panel-body { padding: 20px; }

/* â”€â”€ GRID LAYOUTS â”€â”€ */
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }

/* â”€â”€ TABLE â”€â”€ */
.data-table { width: 100%; border-collapse: collapse; font-size: 13px; }

.data-table th {
  padding: 10px 14px;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--muted);
  text-align: left;
  border-bottom: 1px solid var(--border);
  white-space: nowrap;
}

.data-table td {
  padding: 12px 14px;
  border-bottom: 1px solid var(--border);
  vertical-align: middle;
}

.data-table tr:last-child td { border-bottom: none; }

.data-table tbody tr { transition: background 0.15s; }
.data-table tbody tr:hover { background: var(--bg-3); }

/* â”€â”€ BADGES â”€â”€ */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 3px 8px;
  border-radius: 6px;
  font-size: 11px;
  font-weight: 500;
}

.badge-green { background: rgba(34,217,138,0.12); color: var(--green); }
.badge-red   { background: rgba(255,83,112,0.12);  color: var(--red); }
.badge-amber { background: rgba(255,184,108,0.12); color: var(--amber); }
.badge-blue  { background: rgba(77,196,255,0.12);  color: var(--blue); }
.badge-purple{ background: rgba(124,92,252,0.15);  color: var(--accent-2); }
.badge-muted { background: var(--bg-4);            color: var(--muted-2); }

/* â”€â”€ BUTTONS â”€â”€ */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 14px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  border: none;
  text-decoration: none;
  transition: all 0.15s;
  font-family: 'DM Sans', sans-serif;
  white-space: nowrap;
}

.btn svg { width: 14px; height: 14px; }

.btn-primary {
  background: var(--accent);
  color: #fff;
  box-shadow: 0 2px 12px var(--accent-glow);
}
.btn-primary:hover { background: var(--accent-2); }

.btn-ghost {
  background: var(--bg-3);
  color: var(--text);
  border: 1px solid var(--border);
}
.btn-ghost:hover { background: var(--bg-4); border-color: var(--border-2); }

.btn-danger { background: rgba(255,83,112,0.12); color: var(--red); border: 1px solid rgba(255,83,112,0.2); }
.btn-danger:hover { background: rgba(255,83,112,0.2); }

.btn-success { background: rgba(34,217,138,0.12); color: var(--green); border: 1px solid rgba(34,217,138,0.2); }
.btn-success:hover { background: rgba(34,217,138,0.2); }

.btn-sm { padding: 5px 10px; font-size: 12px; }
.btn-icon { padding: 7px; width: 32px; height: 32px; justify-content: center; }

/* â”€â”€ FORM CONTROLS â”€â”€ */
.form-group { margin-bottom: 18px; }
.form-label { display: block; font-size: 12px; font-weight: 500; color: var(--muted-2); margin-bottom: 6px; }

.form-control {
  width: 100%;
  background: var(--bg-3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 9px 12px;
  font-size: 13px;
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  outline: none;
  transition: border-color 0.15s;
}

.form-control:focus { border-color: var(--accent); }
.form-control::placeholder { color: var(--muted); }

textarea.form-control { resize: vertical; min-height: 80px; }

/* â”€â”€ TOGGLE â”€â”€ */
.toggle {
  position: relative;
  display: inline-block;
  width: 36px; height: 20px;
  cursor: pointer;
}

.toggle input { opacity: 0; width: 0; height: 0; }

.toggle-slider {
  position: absolute;
  inset: 0;
  background: var(--bg-4);
  border-radius: 20px;
  transition: 0.2s;
}

.toggle-slider::before {
  content: '';
  position: absolute;
  width: 14px; height: 14px;
  left: 3px; top: 3px;
  background: var(--muted);
  border-radius: 50%;
  transition: 0.2s;
}

.toggle input:checked + .toggle-slider { background: rgba(34,217,138,0.25); }
.toggle input:checked + .toggle-slider::before { transform: translateX(16px); background: var(--green); }

/* â”€â”€ AVATAR â”€â”€ */
.avatar {
  width: 30px; height: 30px;
  border-radius: 8px;
  background: linear-gradient(135deg, var(--accent), #5b3fd4);
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 600;
  flex-shrink: 0;
}

/* â”€â”€ SEARCH BAR â”€â”€ */
.search-bar {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--bg-3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px 12px;
}

.search-bar svg { width: 14px; height: 14px; color: var(--muted); flex-shrink: 0; }

.search-bar input {
  background: none; border: none; outline: none;
  color: var(--text); font-size: 13px;
  font-family: 'DM Sans', sans-serif;
  width: 100%;
}

/* â”€â”€ FILTERS BAR â”€â”€ */
.filters-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.filter-select {
  background: var(--bg-3);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 7px 10px;
  font-size: 12px;
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  outline: none;
  cursor: pointer;
}

.filter-select:focus { border-color: var(--accent); }

/* â”€â”€ PAGINATION â”€â”€ */
.pagination {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 16px 20px;
  border-top: 1px solid var(--border);
}

.page-link {
  width: 30px; height: 30px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 7px;
  font-size: 12px;
  color: var(--muted-2);
  text-decoration: none;
  transition: all 0.15s;
}

.page-link:hover { background: var(--bg-3); color: var(--text); }
.page-link.active { background: var(--accent); color: #fff; }

/* â”€â”€ CHART PLACEHOLDER â”€â”€ */
.chart-container { position: relative; }
canvas { width: 100% !important; }

/* â”€â”€ EMPTY STATE â”€â”€ */
.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 60px 20px;
  color: var(--muted);
}

.empty-state svg { width: 48px; height: 48px; margin-bottom: 12px; opacity: 0.4; }
.empty-state p { font-size: 13px; }

/* â”€â”€ ALERTS â”€â”€ */
.alert {
  padding: 12px 16px;
  border-radius: 9px;
  font-size: 13px;
  margin-bottom: 16px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.alert-success { background: rgba(34,217,138,0.1); color: var(--green); border: 1px solid rgba(34,217,138,0.2); }
.alert-error   { background: rgba(255,83,112,0.1);  color: var(--red);   border: 1px solid rgba(255,83,112,0.2); }
.alert-info    { background: rgba(77,196,255,0.1);  color: var(--blue);  border: 1px solid rgba(77,196,255,0.2); }

/* â”€â”€ MODAL â”€â”€ */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s;
}

.modal-overlay.open { opacity: 1; pointer-events: all; }

.modal {
  background: var(--bg-2);
  border: 1px solid var(--border-2);
  border-radius: 16px;
  padding: 28px;
  width: 100%;
  max-width: 440px;
  transform: translateY(10px);
  transition: transform 0.2s;
}

.modal-overlay.open .modal { transform: translateY(0); }

.modal-title {
  font-family: 'Syne', sans-serif;
  font-weight: 700;
  font-size: 17px;
  margin-bottom: 6px;
}

.modal-desc { font-size: 13px; color: var(--muted-2); margin-bottom: 20px; }
.modal-actions { display: flex; gap: 10px; margin-top: 20px; justify-content: flex-end; }

/* â”€â”€ USER CELL â”€â”€ */
.user-cell { display: flex; align-items: center; gap: 10px; }
.user-info .name { font-size: 13px; font-weight: 500; }
.user-info .email { font-size: 11px; color: var(--muted); }

/* â”€â”€ SPARKLINE â”€â”€ */
.sparkline { display: flex; align-items: flex-end; gap: 2px; height: 30px; }
.spark-bar { flex: 1; background: var(--accent); border-radius: 2px 2px 0 0; opacity: 0.6; transition: opacity 0.15s; }
.spark-bar:hover { opacity: 1; }

/* â”€â”€ PAGE HEADER â”€â”€ */
.page-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 24px;
  gap: 16px;
}

.page-header-left {}
.page-header h1 {
  font-family: 'Syne', sans-serif;
  font-weight: 800;
  font-size: 22px;
  margin-bottom: 3px;
}

.page-header p { font-size: 13px; color: var(--muted); }
.page-header-right { display: flex; gap: 8px; align-items: center; flex-shrink: 0; }

/* â”€â”€ DIVIDER â”€â”€ */
.divider { border: none; border-top: 1px solid var(--border); margin: 20px 0; }

/* â”€â”€ RESPONSIVE â”€â”€ */
@media (max-width: 900px) {
  .sidebar { transform: translateX(-100%); }
  .sidebar.open { transform: translateX(0); }
  .main { margin-left: 0; }
  .grid-2, .grid-3 { grid-template-columns: 1fr; }
  .stats-grid { grid-template-columns: 1fr 1fr; }
}

@media (max-width: 540px) {
  .stats-grid { grid-template-columns: 1fr; }
  .content { padding: 16px; }
}

/* â”€â”€ TOAST â”€â”€ */
#toast-stack {
  position: fixed;
  bottom: 24px;
  right: 24px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  z-index: 9999;
}

.toast {
  background: var(--bg-3);
  border: 1px solid var(--border-2);
  border-radius: 10px;
  padding: 12px 16px;
  font-size: 13px;
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 260px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.5);
  animation: slideIn 0.25s ease;
}

.toast.success { border-color: rgba(34,217,138,0.3); }
.toast.error   { border-color: rgba(255,83,112,0.3); }

@keyframes slideIn {
  from { opacity: 0; transform: translateX(20px); }
  to   { opacity: 1; transform: translateX(0); }
}
</style>
{% block extra_css %}{% endblock %}
</head>
<body>
<div id="toast-stack"></div>

<div class="layout">
  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-logo">
      <div class="logo-icon">ðŸŽµ</div>
      <div class="logo-text">Stream<span>ify</span></div>
    </div>

    <div style="overflow-y: auto; flex: 1;">
      <div class="sidebar-label">Overview</div>
      <a href="{% url 'admin_panel:dashboard' %}" class="nav-item {% block nav_dashboard %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
        Dashboard
      </a>

      <div class="sidebar-label">Management</div>
      <a href="{% url 'admin_panel:users' %}" class="nav-item {% block nav_users %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
        Users
      </a>
      <a href="{% url 'admin_panel:content' %}" class="nav-item {% block nav_content %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2"/></svg>
        Content
      </a>
      <a href="{% url 'admin_panel:comments' %}" class="nav-item {% block nav_comments %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        Comments
      </a>
      <a href="{% url 'admin_panel:genres' %}" class="nav-item {% block nav_genres %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>
        Genres
      </a>

      <div class="sidebar-label">Revenue</div>
      <a href="{% url 'admin_panel:subscriptions' %}" class="nav-item {% block nav_subs %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        Subscriptions
      </a>
      <a href="{% url 'admin_panel:plans' %}" class="nav-item {% block nav_plans %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
        Plans
      </a>
      <a href="{% url 'admin_panel:payments' %}" class="nav-item {% block nav_payments %}{% endblock %}">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
        Payments
      </a>

      <div class="sidebar-label">Site</div>
      <a href="/" class="nav-item" target="_blank">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
        View Site
      </a>
    </div>

    <div class="sidebar-footer">
      <div class="admin-card">
        <div class="admin-avatar">{{ request.user.name|first|upper }}</div>
        <div>
          <div class="admin-name">{{ request.user.name|truncatechars:16 }}</div>
          <div class="admin-role">{{ request.user.get_role_display }}</div>
        </div>
        <a href="{% url 'admin_panel:logout' %}" style="margin-left:auto; color: var(--muted); display:flex; align-items:center;" title="Logout">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
        </a>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <div class="main">
    <header class="header">
      <button id="menu-toggle" onclick="document.getElementById('sidebar').classList.toggle('open')" style="display:none; background:none; border:none; color:var(--text); cursor:pointer; padding:4px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
      </button>
      <div>
        <div class="header-title">{% block header_title %}Dashboard{% endblock %}</div>
      </div>
      <div class="header-right">
        {% block header_actions %}{% endblock %}
        <div style="width:8px; height:8px; background:var(--green); border-radius:50%; box-shadow:0 0 8px var(--green);" title="System online"></div>
      </div>
    </header>

    <div class="content">
      {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{% if message.tags == 'error' %}error{% elif message.tags == 'success' %}success{% else %}info{% endif %}">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
          {{ message }}
        </div>
        {% endfor %}
      {% endif %}

      {% block content %}{% endblock %}
    </div>
  </div>
</div>

<script>
// Mobile menu
if(window.innerWidth <= 900) {
  document.getElementById('menu-toggle').style.display = 'flex';
}
window.addEventListener('resize', () => {
  document.getElementById('menu-toggle').style.display = window.innerWidth <= 900 ? 'flex' : 'none';
});

// Toast system
function showToast(msg, type = 'success') {
  const stack = document.getElementById('toast-stack');
  const t = document.createElement('div');
  t.className = `toast ${type}`;
  const icon = type === 'success'
    ? '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="20 6 9 17 4 12"/></svg>'
    : '<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>';
  t.innerHTML = icon + msg;
  stack.appendChild(t);
  setTimeout(() => t.remove(), 3500);
}

// CSRF helper
function getCsrf() {
  const c = document.cookie.split(';').find(c => c.trim().startsWith('csrftoken='));
  return c ? c.split('=')[1] : '';
}

// Toggle helpers
function postToggle(url, callback) {
  fetch(url, {
    method: 'POST',
    headers: { 'X-CSRFToken': getCsrf() }
  })
  .then(r => r.json())
  .then(callback)
  .catch(() => showToast('Request failed', 'error'));
}
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
